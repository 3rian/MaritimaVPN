<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mar√≠timaVPN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #0e1a2b; color: white; font-family: Arial, sans-serif; }
        .hero { text-align: center; padding: 80px 20px; }
        .plans { padding: 60px 20px; }
        .plan-card {
            background: #14263f; border-radius: 12px; padding: 25px; text-align: center;
            box-shadow: 0 0 12px rgba(0,0,0,0.3);
        }
        .modal-content { background: #14263f; color: white; border-radius: 12px; }
        footer { text-align: center; padding: 20px; opacity: 0.7; }
    </style>
    
</head>

<body>

<script>
const API_URL = "http://127.0.0.1:8000";
let USER_ID = null;
</script>

<!-- NAVBAR -->
<nav class="navbar navbar-dark bg-dark navbar-expand-lg px-3">
    <a class="navbar-brand d-flex align-items-center" href="#">
        <img src="imagens/logo-maritima-vpn-quadrado.jpg" width="50" class="me-2">
        <span class="fw-bold">Mar√≠timaVPN</span>
    </a>

    <button class="btn btn-outline-light ms-auto me-2" id="myPlansBtn" onclick="openPlans()" style="display:none;">
        Meus Planos
    </button>

    <button class="btn btn-primary ms-auto" data-bs-toggle="modal" data-bs-target="#loginModal" id="loginBtn">
        Entrar
    </button>

    <button class="btn btn-danger ms-2" id="logoutBtn" onclick="logout()" style="display:none;">
        Sair
    </button>
</nav>

<!-- HERO -->
<!-- HERO -->
<section class="hero">
    <h1 class="fw-bold">Proteja sua conex√£o com a Mar√≠timaVPN</h1>
    <p class="mt-3">Servidor no Canad√° üá®üá¶ ‚Äî Alta velocidade, seguran√ßa e estabilidade</p>
</section>

<!-- SOBRE A MAR√çTIMA VPN -->
<section class="container py-5">
    <h2 class="text-center fw-bold mb-4">Conhe√ßa Nossa VPN: Seguran√ßa, Liberdade e Internet Sem Limites</h2>

    <div class="row g-4">

        <!-- COLUNA 1 - PRIVACIDADE -->
        <div class="col-md-6">
            <div class="plan-card p-4">
                <h4 class="fw-bold mb-3 text-info">üõ°Ô∏è Usu√°rios que Buscam Privacidade e Liberdade</h4>
                <p class="opacity-75">Perfeito para quem quer navegar com seguran√ßa, anonimato e acessar conte√∫dos sem barreiras.</p>

                <ul class="mt-3">
                    <li>Burlar bloqueios e acessar sites restritos</li>
                    <li>Abrir conte√∫dos de outros pa√≠ses</li>
                    <li>Desbloquear cat√°logos internacionais de streaming</li>
                    <li>Navega√ß√£o sem censura e sem limites geogr√°ficos</li>
                    <li>Compat√≠vel com servi√ßos de IPTV</li>
                </ul>
            </div>
        </div>

        <!-- COLUNA 2 - INTERNET M√ìVEL ILIMITADA -->
        <div class="col-md-6">
            <div class="plan-card p-4">
                <h4 class="fw-bold mb-3 text-success">üì± Usu√°rios que Querem Internet M√≥vel Ilimitada</h4>
                <p class="opacity-75">Ideal para quem utiliza HTTP Injector e apps semelhantes para continuar navegando ap√≥s o fim da franquia.</p>

                <ul class="mt-3">
                    <li>Internet al√©m da franquia da operadora</li>
                    <li>Compat√≠vel com HTTP Injector, SSL (Stunnel)</li>
                    <li>Perfeito para VoIP (liga√ß√µes) e Jogos online</li>
                    <li>Tr√°fego ilimitado ‚Äî 1 aparelho por conta</li>
                    <li>Conex√£o est√°vel para trabalho, estudo e lazer</li>
                
                </ul>
            </div>
        </div>

    </div>
</section>


<!-- PLANOS -->
<section class="plans container">
    <h2 class="text-center mb-4">Planos Dispon√≠veis</h2>
    <div class="row g-4 justify-content-center">

        <div class="col-md-4">
            <div class="plan-card">
                <h3>30 dias</h3>
                <p class="display-6">R$ 12,00</p>
                <button class="btn btn-primary w-100" onclick="buyPlan(30)">Comprar</button>
            </div>
        </div>

        <div class="col-md-4">
            <div class="plan-card">
                <h3>15 dias</h3>
                <p class="display-6">R$ 7,00</p>
                <button class="btn btn-primary w-100" onclick="buyPlan(15)">Comprar</button>
            </div>
        </div>

    </div>
</section>

<!-- LOGIN MODAL -->
<div class="modal fade" id="loginModal">
  <div class="modal-dialog">
    <div class="modal-content p-3">

      <div class="modal-header border-0">
        <h5 class="modal-title">Entrar</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <form id="loginForm">
            <div class="mb-3">
                <label>Email</label>
                <input id="loginEmail" type="email" class="form-control" required>
            </div>

            <div class="mb-3">
                <label>Senha</label>
                <input id="loginPassword" type="password" class="form-control" required>
            </div>

            <button class="btn btn-primary w-100" type="submit">Entrar</button>

            <div class="text-center mt-3">
                <a href="#" class="text-info" onclick="showRegister()">Criar conta</a>
            </div>
        </form>
      </div>

    </div>
  </div>
</div>

<!-- REGISTER MODAL -->
<div class="modal fade" id="registerModal">
  <div class="modal-dialog">
    <div class="modal-content p-3">

      <div class="modal-header border-0">
        <h5 class="modal-title">Criar Conta</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <form id="registerForm">
            <div class="mb-3">
                <label>Nome</label>
                <input id="regName" class="form-control" required>
            </div>

            <div class="mb-3">
                <label>Email</label>
                <input id="regEmail" type="email" class="form-control" required>
            </div>

            <div class="mb-3">
                <label>Senha</label>
                <input id="regPassword" type="password" class="form-control" required>
            </div>

            <button class="btn btn-success w-100" type="submit">Cadastrar</button>
        </form>
      </div>

    </div>
  </div>
</div>

<!-- MEUS PLANOS MODAL -->
<div class="modal fade" id="plansModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content p-3">
            <div class="modal-header border-0">
                <h5>Meus Planos</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body" id="plansList">
                Carregando...
            </div>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer>¬© 2025 Mar√≠timaVPN ‚Äî Seguran√ßa em alto n√≠vel</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>

// ---------------------------
// LOGIN
// ---------------------------
document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const email = loginEmail.value;
    const password = loginPassword.value;

    const req = await fetch(API_URL + "/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
    });

    const res = await req.json();

    if (res.user_id) {
        USER_ID = res.user_id;

        loginBtn.style.display = "none";
        logoutBtn.style.display = "inline-block";
        myPlansBtn.style.display = "inline-block";

        bootstrap.Modal.getInstance(loginModal).hide();
        alert("Login realizado com sucesso!");

    } else {
        alert("Credenciais inv√°lidas");
    }
});

// ---------------------------
// CADASTRO
// ---------------------------
document.getElementById("registerForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const req = await fetch(API_URL + "/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            name: regName.value,
            email: regEmail.value,
            password: regPassword.value
        })
    });

    const res = await req.json();
    alert(res.message || "Conta criada!");

    bootstrap.Modal.getInstance(registerModal).hide();
});

// ---------------------------
// COMPRAR PLANO
// ---------------------------
async function buyPlan(days) {

    if (!USER_ID) {
        alert("Voc√™ precisa estar logado para comprar um plano.");
        return;
    }

    const req = await fetch(API_URL + "/create-plan", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ user_id: USER_ID, plan: String(days) })
    });

    const res = await req.json();

    if (res.ehi) {
        alert("Plano criado com sucesso! Seu arquivo EHI est√° dispon√≠vel em Meus Planos.");

        // Download imediato do EHI
        let link = document.createElement("a");
        link.href = "data:application/octet-stream;base64," + res.ehi;
        link.download = `MaritimaVPN_${days}dias.ehi`;
        link.click();

    } else {
        alert("Erro ao criar o plano.");
    }
}

// ---------------------------
// MEUS PLANOS
// ---------------------------
async function openPlans() {
    if (!USER_ID) return;

    const req = await fetch(API_URL + "/get-plans/" + USER_ID);
    const plans = await req.json();

    let html = "";
    plans.forEach(p => {
        html += `
            <div class="p-3 mb-3" style="background:#14263f; border-radius:10px;">
                <h5>${p.plan} dias</h5>
                <p>Usu√°rio SSH: <b>${p.username}</b></p>
                <p>Validade: <b>${p.expires}</b></p>

                <a class="btn btn-success btn-sm"
                   href="data:application/octet-stream;base64,${p.ehi_file}"
                   download="MaritimaVPN_${p.username}.ehi">Download EHI</a>

                <button class="btn btn-warning btn-sm" onclick="renewPlan(${p.id})">Renovar</button>
                <button class="btn btn-danger btn-sm" onclick="cancelPlan(${p.id})">Cancelar</button>
            </div>
        `;
    });

    plansList.innerHTML = html;
    new bootstrap.Modal(plansModal).show();
}

// ---------------------------
// RENOVAR PLANO
// ---------------------------
async function renewPlan(id) {
    const days = prompt("Por quantos dias deseja renovar?", "30");
    if (!days) return;

    const req = await fetch(API_URL + "/renew-plan", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ account_id: id, days: Number(days) })
    });

    const res = await req.json();

    if (res.ehi) {
        alert("Plano renovado com sucesso!");

        let link = document.createElement("a");
        link.href = "data:application/octet-stream;base64," + res.ehi;
        link.download = `MaritimaVPN_Renovado_${days}dias.ehi`;
        link.click();

        openPlans();
    }
}

// ---------------------------
// CANCELAR PLANO
// ---------------------------
async function cancelPlan(id) {

    if (!confirm("Tem certeza que deseja cancelar este plano?")) return;

    const req = await fetch(API_URL + "/cancel-plan?account_id=" + id, {
        method: "POST"
    });

    const res = await req.json();

    alert(res.message || "Plano cancelado.");

    openPlans();
}

// ---------------------------
// LOGOUT
// ---------------------------
function logout() {
    USER_ID = null;
    loginBtn.style.display = "inline-block";
    logoutBtn.style.display = "none";
    myPlansBtn.style.display = "none";
    alert("Voc√™ saiu.");
}

// ---------------------------
// UI SWITCH REGISTER
// ---------------------------
function showRegister() {
    bootstrap.Modal.getInstance(loginModal).hide();
    new bootstrap.Modal(registerModal).show();
}

</script>

</body>
</html>
